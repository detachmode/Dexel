<UserControl
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:views="clr-namespace:Dexel.Editor.Views"
    xmlns:viewModels="clr-namespace:Dexel.Editor.ViewModels"
    xmlns:drawingBoard="clr-namespace:Dexel.Editor.Views.DrawingBoard"
    x:Class="Dexel.Editor.Views.DrawingBoard.IOCell"
    x:Name="TheIoCell"
    d:DataContext="{d:DesignInstance viewModels:IOCellViewModel, IsDesignTimeCreatable=True}"
    mc:Ignorable="d">

    <UserControl.Resources>
        <ContextMenu x:Key="MyContextMenu">
            <MenuItem Header="Add New Input" Click="NewInput_click" />
            <MenuItem Header="Add New Output" Click="NewOutput_click" />
            <Separator></Separator>
            <MenuItem Header="Make Integration" Click="MakeIntegration_OnClick"></MenuItem>
            <MenuItem Header="Remove from Integration" Click="RemoveFromIntegration_OnClick"></MenuItem>
            <Separator></Separator>
          
            <MenuItem Header="Copy" Click="Copy_click" />
            <!--<MenuItem Header="Cut" Click="Cut_click" />-->
            <MenuItem Header="Delete" Click="Delete_click" />
        </ContextMenu>
    </UserControl.Resources>
    <Grid>
        <ItemsControl MinHeight="35" x:Name="InputFlow" 
                      HorizontalAlignment="Left"
                      VerticalAlignment="Center"
                      ItemsSource="{Binding DangelingInputs}" RenderTransformOrigin="0.5,0.5" >
            <ItemsControl.RenderTransform>
                <TransformGroup>
                    <ScaleTransform/>
                    <SkewTransform/>
                    <RotateTransform/>
                    <TranslateTransform X="{Binding ActualWidth, ConverterParameter=-1, Converter={StaticResource PercentageConverter}, Mode=OneWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ItemsControl}}}"/>
                </TransformGroup>
            </ItemsControl.RenderTransform>


            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <drawingBoard:DangelingConnectionView  x:Name="DangelingConnectionView" />
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <StackPanel 
            ContextMenu="{StaticResource MyContextMenu}"
            MinHeight="60"
            Orientation="Horizontal"
            >

            <drawingBoard:SoftwareCell x:Name="Fu" 
                                Focusable="False"
                            LabelContent="{Binding Model.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           />

            <ItemsControl VerticalAlignment="Center" HorizontalAlignment="Center"  Panel.ZIndex="20"
                      x:Name="OutputFlow" ItemsSource="{Binding DangelingOutputs, Mode=TwoWay}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <drawingBoard:DangelingConnectionView x:Name="DangelingConnectionView">

                        </drawingBoard:DangelingConnectionView>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>
    </Grid>
</UserControl>